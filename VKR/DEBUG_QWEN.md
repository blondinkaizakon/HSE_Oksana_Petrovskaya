# Отладка работы с локальной моделью Qwen

## Проблема
Модель возвращает статус `{"status":"ok","model_loaded":true}`, но приложение не работает.

## Возможные причины

### 1. CORS проблема
Браузер не может обратиться к `localhost:8001` из-за политики CORS.

**Решение:** Используем прямой IP или настраиваем CORS правильно.

### 2. Модель не возвращает JSON
Модель генерирует текст, но не в формате JSON.

**Решение:** Улучшен парсинг и добавлен fallback.

### 3. Медленная генерация
Модель на CPU работает медленно (15-30 секунд).

**Решение:** Это нормально, нужно увеличить timeout.

## Проверка

### Проверить API:
```bash
curl http://localhost:8001/health
```

### Проверить генерацию:
```bash
curl -X POST http://localhost:8001/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "Тест", "max_new_tokens": 50}'
```

### Проверить CORS:
Откройте DevTools в браузере (F12) и проверьте вкладку Network на ошибки.

## Решение

1. Используем прямой URL с IP адресом
2. Улучшен парсинг ответов
3. Добавлен fallback для не-JSON ответов

